<app-header [breadcrumb]="breadcrumb"></app-header>

<div class="app-grid justify-content-center content">
  <div class="app-col-12 app-col-md-10 app-col-lg-9 p-0 m-0">
    <mat-card>
      <mat-card-header>
        <mat-card-title>Fahrzeug Check â€“ {{ fahrzeug?.name }}</mat-card-title>
      </mat-card-header>

      <mat-card-content>
        <form [formGroup]="form" class="d-flex flex-column gap-3">
          <mat-form-field>
            <mat-label>Titel</mat-label>
            <input matInput formControlName="title" placeholder="z. B. Tagescheck" />
          </mat-form-field>

          <mat-form-field>
            <mat-label>Allgemeine Notiz</mat-label>
            <textarea matInput rows="2" formControlName="notiz"></textarea>
          </mat-form-field>

          <mat-divider></mat-divider>

          <div formArrayName="results" class="d-flex flex-column gap-3">
            @for (raum of raeumeView; track raum.name) {
              <mat-card class="p-2">
                <h3 class="m-0 mb-2">{{ raum.name }}</h3>

                @for (item of raum.items; track item.index) {
                  <div class="app-grid align-items-center mb-2" [formGroupName]="item.index">
                    <div class="app-col-12 app-col-md-6">
                      <mat-checkbox formControlName="checked">
                        {{ item.name }} (Soll: {{ item.menge }} {{ item.einheit }})
                      </mat-checkbox>
                    </div>

                    <div class="app-col-12 app-col-md-6">
                      <mat-form-field class="w-100">
                        <mat-label>Notiz</mat-label>
                        <input matInput formControlName="notiz" placeholder="Optional" />
                      </mat-form-field>
                    </div>
                  </div>
                }
              </mat-card>
            }
          </div>

          <button mat-flat-button color="accent" type="button" (click)="submit()">
            Checkliste speichern
          </button>
        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>
